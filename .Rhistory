mapa_amba_ext
View(data_mapa_amba)
View(dptos_pba)
# --- 3. PARTIDOS PBA NOMBRE ANSES     -> tuve que reordenar para pegarlo al df
partidos_pba_anses <-  c(
"25 de Mayo" , "9 de Julio" , "Adolfo Alsina" , "Adolfo Gonzales Chaves" , "Alberti" ,
"Almirante Brown" , "Arrecifes" , "Avellaneda" , "Ayacucho" , "Azul" , "Bahía Blanca" ,
"Balcarce" , "Baradero" , "Benito Juárez" , "Berazategui" , "Berisso" , "Bolívar" ,
"Bragado" , "Brandsen" , "Campana"  , "Capitán Sarmiento" , "Carlos Casares" ,
"Carlos Tejedor" , "Carmen de Areco" , "Castelli" , "Cañuelas",  "Chacabuco" , "Chascomús" , "Chivilcoy" ,
"Colón"  , "Coronel Dorrego" , "Coronel Pringles" ,  "Coronel Suárez" , "Coronel de Marina Leonardo Rosales",
"Daireaux" , "Dolores" , "Ensenada" , "Escobar" , "Esteban Echeverría" ,
"Exaltación de la Cruz" , "Ezeiza" , "Florencio Varela" , "Florentino Ameghino" ,
"General Alvarado" , "General Alvear" , "General Arenales" , "General Belgrano" ,
"General Guido" , "General Juan Madariaga" , "General La Madrid" , "General Las Heras"
, "General Lavalle" , "General Paz" , "General Pinto" , "General Pueyrredón" , "General Rodríguez"
, "General San Martín" , "General Viamonte" , "General Villegas" , "Guaminí" , "Hipólito Yrigoyen"
, "Hurlingham" , "Ituzaingó" , "José C. Paz" , "Junín" , "La Costa" , "La Matanza" , "La Plata" , "Lanús" ,
"Laprida" , "Las Flores" , "Leandro N. Alem" , "Lezama", "Lincoln" , "Lobería" , "Lobos" , "Lomas de Zamora" , "Luján"   # Tuve que agregar Lezama
, "Magdalena" , "Maipú" , "Malvinas Argentinas" , "Mar Chiquita" , "Marcos Paz" , "Mercedes" , "Merlo" , "Monte"
, "Monte Hermoso" , "Moreno" , "Morón" , "Navarro" , "Necochea" , "Olavarría" , "Patagones" , "Pehuajó" , "Pellegrini"
, "Pergamino" , "Pila" , "Pilar" , "Pinamar" , "Presidente Perón" , "Puán" , "Punta Indio" , "Quilmes" , "Ramallo" ,
"Rauch" , "Rivadavia" , "Rojas" , "Roque Pérez" , "Saavedra" , "Saladillo" , "Salliqueló" , "Salto" , "San Andrés de Giles" ,
"San Antonio de Areco" , "San Cayetano" , "San Fernando" , "San Isidro" , "San Miguel" , "San Nicolás" , "San Pedro" ,
"San Vicente" , "Suipacha" , "Tandil" , "Tapalqué" , "Tigre" , "Tordillo" , "Tornquist" , "Trenque Lauquen" , "Tres Arroyos"
,"Tres Lomas", "Tres de Febrero" , "Vicente López" , "Villa Gesell" , "Villarino" , "Zárate"
)
# --- 4. AGREGAR CAMPO PARTIDO_ANSES
dptos_pba <- dptos_pba %>%
mutate(partidos_pba_anses = partidos_pba_anses )
# --- 5. OBTENER CABA SIN COMUNAS
caba_union <- dptos %>%
filter(grepl("^02", in1)) %>%
st_make_valid() %>%
summarise(geometry = st_union(geometry)) %>%
st_cast("MULTIPOLYGON") %>%
mutate(partido = "CABA",
partidos_pba_anses = "CABA")
# AGREGAR CABA A DF PBA
dptos_pba_caba <- bind_rows(dptos_pba, caba_union)
# --- 6. CARGAR DATOS DE COBERTURA
cobertura_pba_caba <- read_excel("mapa_cobertura_amba.xlsx")
# --- 7. UNIR GEODATA CON COBERTURA
data_mapa_pba_caba <- dptos_pba_caba %>%
left_join(cobertura_pba_caba, by = c("partidos_pba_anses" = "partidos_pba_anses"))
partidos_amba_ext <- c(
"Almirante Brown", "Avellaneda", "Berazategui", "Berisso", "Brandsen",
"Campana", "Cañuelas", "Ensenada", "Escobar", "Esteban Echeverría",
"Exaltación de la Cruz", "Ezeiza", "Florencio Varela", "General Las Heras",
"General Rodríguez", "General San Martín", "Hurlingham", "Ituzaingó",
"José C. Paz", "La Matanza", "Lanús", "La Plata", "Lomas de Zamora",
"Luján", "Marcos Paz", "Malvinas Argentinas", "Moreno", "Merlo", "Morón",
"Pilar", "Presidente Perón", "Quilmes", "San Fernando", "San Isidro",
"San Miguel", "San Vicente", "Tigre", "Tres de Febrero", "Vicente López",
"Zárate", "CABA"
)
# ---9. ILTRAR PARTIDOS DE PBA QUE ESTÉN LISTADOS
data_mapa_amba <- data_mapa_pba_caba %>%
filter(partidos_pba_anses %in% partidos_amba_ext)
# --- 10. GRAFICAR MAPA DE PARTIDOS LISTADOS
mapa_amba_ext <- ggplot(data_mapa_amba) +
geom_sf(aes(fill = Cobertura), color = "white") +
scale_fill_gradient(
low = "#c6dbef",
high = "#08306b",
name = "% Cobertura"
) +
theme_minimal() +
labs(
title = "Cobertura por Partido - AMBA",
caption = "Fuente: IGN / Elaboración propia"
) +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
mapa_amba_ext
View(mapa_amba_ext)
View(dptos_pba)
# --- 1. CARGAR SHAPEFILE IGN
dptos <- st_read("departamento/departamentoPolygon.shp")
# --- 2. FILTRAR PARTIDOS DE PBA
dptos_pba <- dptos %>%
filter(grepl("^06", in1)) %>%
mutate(partido = nam) %>%
arrange(partido)
# --- 3. PARTIDOS PBA NOMBRE ANSES     -> tuve que reordenar para pegarlo al df
partidos_pba_anses <-  c(
"25 de Mayo" , "9 de Julio" , "Adolfo Alsina" , "Adolfo Gonzales Chaves" , "Alberti" ,
"Almirante Brown" , "Arrecifes" , "Avellaneda" , "Ayacucho" , "Azul" , "Bahía Blanca" ,
"Balcarce" , "Baradero" , "Benito Juárez" , "Berazategui" , "Berisso" , "Bolívar" ,
"Bragado" , "Brandsen" , "Campana"  , "Capitán Sarmiento" , "Carlos Casares" ,
"Carlos Tejedor" , "Carmen de Areco" , "Castelli" , "Cañuelas",  "Chacabuco" , "Chascomús" , "Chivilcoy" ,
"Colón"  , "Coronel Dorrego" , "Coronel Pringles" ,  "Coronel Suárez" , "Coronel de Marina Leonardo Rosales",
"Daireaux" , "Dolores" , "Ensenada" , "Escobar" , "Esteban Echeverría" ,
"Exaltación de la Cruz" , "Ezeiza" , "Florencio Varela" , "Florentino Ameghino" ,
"General Alvarado" , "General Alvear" , "General Arenales" , "General Belgrano" ,
"General Guido" , "General Juan Madariaga" , "General La Madrid" , "General Las Heras"
, "General Lavalle" , "General Paz" , "General Pinto" , "General Pueyrredón" , "General Rodríguez"
, "General San Martín" , "General Viamonte" , "General Villegas" , "Guaminí" , "Hipólito Yrigoyen"
, "Hurlingham" , "Ituzaingó" , "José C. Paz" , "Junín" , "La Costa" , "La Matanza" , "La Plata" , "Lanús" ,
"Laprida" , "Las Flores" , "Leandro N. Alem" , "Lezama", "Lincoln" , "Lobería" , "Lobos" , "Lomas de Zamora" , "Luján"   # Tuve que agregar Lezama
, "Magdalena" , "Maipú" , "Malvinas Argentinas" , "Mar Chiquita" , "Marcos Paz" , "Mercedes" , "Merlo" , "Monte"
, "Monte Hermoso" , "Moreno" , "Morón" , "Navarro" , "Necochea" , "Olavarría" , "Patagones" , "Pehuajó" , "Pellegrini"
, "Pergamino" , "Pila" , "Pilar" , "Pinamar" , "Presidente Perón" , "Puán" , "Punta Indio" , "Quilmes" , "Ramallo" ,
"Rauch" , "Rivadavia" , "Rojas" , "Roque Pérez" , "Saavedra" , "Saladillo" , "Salliqueló" , "Salto" , "San Andrés de Giles" ,
"San Antonio de Areco" , "San Cayetano" , "San Fernando" , "San Isidro" , "San Miguel" , "San Nicolás" , "San Pedro" ,
"San Vicente" , "Suipacha" , "Tandil" , "Tapalqué" , "Tigre" , "Tordillo" , "Tornquist" , "Trenque Lauquen" , "Tres Arroyos"
,"Tres Lomas", "Tres de Febrero" , "Vicente López" , "Villa Gesell" , "Villarino" , "Zárate"
)
# --- 4. AGREGAR CAMPO PARTIDO_ANSES
dptos_pba <- dptos_pba %>%
mutate(partidos_pba_anses = partidos_pba_anses )
# --- 5. OBTENER CABA SIN COMUNAS
caba_union <- dptos %>%
filter(grepl("^02", in1)) %>%
st_make_valid() %>%
summarise(geometry = st_union(geometry)) %>%
st_cast("MULTIPOLYGON") %>%
mutate(partido = "CABA",
partidos_pba_anses = "CABA")
# AGREGAR CABA A DF PBA
dptos_pba_caba <- bind_rows(dptos_pba, caba_union)
# --- 6. CARGAR DATOS DE COBERTURA
cobertura_pba_caba <- read_excel("mapa_cobertura_amba.xlsx")
# --- 7. UNIR GEODATA CON COBERTURA
data_mapa_pba_caba <- dptos_pba_caba %>%
left_join(cobertura_pba_caba, by = c("partidos_pba_anses" = "partidos_pba_anses"))
partidos_amba_ext <- c(
"Almirante Brown", "Avellaneda", "Berazategui", "Berisso", "Brandsen",
"Campana", "Cañuelas", "Ensenada", "Escobar", "Esteban Echeverría",
"Exaltación de la Cruz", "Ezeiza", "Florencio Varela", "General Las Heras",
"General Rodríguez", "General San Martín", "Hurlingham", "Ituzaingó",
"José C. Paz", "La Matanza", "Lanús", "La Plata", "Lomas de Zamora",
"Luján", "Marcos Paz", "Malvinas Argentinas", "Moreno", "Merlo", "Morón",
"Pilar", "Presidente Perón", "Quilmes", "San Fernando", "San Isidro",
"San Miguel", "San Vicente", "Tigre", "Tres de Febrero", "Vicente López",
"Zárate", "CABA"
)
# ---9. ILTRAR PARTIDOS DE PBA QUE ESTÉN LISTADOS
data_mapa_amba <- data_mapa_pba_caba %>%
filter(partidos_pba_anses %in% partidos_amba_ext)
# --- 10. GRAFICAR MAPA DE PARTIDOS LISTADOS
mapa_amba_ext <- ggplot(data_mapa_amba) +
geom_sf(aes(fill = Cobertura), color = "white") +
scale_fill_gradient(
low = "#c6dbef",
high = "#08306b",
name = "% Cobertura"
) +
theme_minimal() +
labs(
title = "Cobertura por Partido - AMBA",
caption = "Fuente: IGN / Elaboración propia"
) +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
mapa_amba_ext
### MAPA AMBA : 40 PARTIDOS + CABA
# --- 1. CARGAR SHAPEFILE IGN
dptos <- st_read("departamento/departamentoPolygon.shp")
# --- 2. FILTRAR PARTIDOS DE PBA
dptos_pba <- dptos %>%
filter(grepl("^06", in1)) %>%
mutate(partido = nam) %>%
arrange(partido)
# --- 3. PARTIDOS PBA NOMBRE ANSES     -> tuve que reordenar para pegarlo al df
partidos_pba_anses <-  c(
"25 de Mayo" , "9 de Julio" , "Adolfo Alsina" , "Adolfo Gonzales Chaves" , "Alberti" ,
"Almirante Brown" , "Arrecifes" , "Avellaneda" , "Ayacucho" , "Azul" , "Bahía Blanca" ,
"Balcarce" , "Baradero" , "Benito Juárez" , "Berazategui" , "Berisso" , "Bolívar" ,
"Bragado" , "Brandsen" , "Campana"  , "Capitán Sarmiento" , "Carlos Casares" ,
"Carlos Tejedor" , "Carmen de Areco" , "Castelli" , "Cañuelas",  "Chacabuco" , "Chascomús" , "Chivilcoy" ,
"Colón"  , "Coronel Dorrego" , "Coronel Pringles" ,  "Coronel Suárez" , "Coronel de Marina Leonardo Rosales",
"Daireaux" , "Dolores" , "Ensenada" , "Escobar" , "Esteban Echeverría" ,
"Exaltación de la Cruz" , "Ezeiza" , "Florencio Varela" , "Florentino Ameghino" ,
"General Alvarado" , "General Alvear" , "General Arenales" , "General Belgrano" ,
"General Guido" , "General Juan Madariaga" , "General La Madrid" , "General Las Heras"
, "General Lavalle" , "General Paz" , "General Pinto" , "General Pueyrredón" , "General Rodríguez"
, "General San Martín" , "General Viamonte" , "General Villegas" , "Guaminí" , "Hipólito Yrigoyen"
, "Hurlingham" , "Ituzaingó" , "José C. Paz" , "Junín" , "La Costa" , "La Matanza" , "La Plata" , "Lanús" ,
"Laprida" , "Las Flores" , "Leandro N. Alem" , "Lezama", "Lincoln" , "Lobería" , "Lobos" , "Lomas de Zamora" , "Luján"   # Tuve que agregar Lezama
, "Magdalena" , "Maipú" , "Malvinas Argentinas" , "Mar Chiquita" , "Marcos Paz" , "Mercedes" , "Merlo" , "Monte"
, "Monte Hermoso" , "Moreno" , "Morón" , "Navarro" , "Necochea" , "Olavarría" , "Patagones" , "Pehuajó" , "Pellegrini"
, "Pergamino" , "Pila" , "Pilar" , "Pinamar" , "Presidente Perón" , "Puán" , "Punta Indio" , "Quilmes" , "Ramallo" ,
"Rauch" , "Rivadavia" , "Rojas" , "Roque Pérez" , "Saavedra" , "Saladillo" , "Salliqueló" , "Salto" , "San Andrés de Giles" ,
"San Antonio de Areco" , "San Cayetano" , "San Fernando" , "San Isidro" , "San Miguel" , "San Nicolás" , "San Pedro" ,
"San Vicente" , "Suipacha" , "Tandil" , "Tapalqué" , "Tigre" , "Tordillo" , "Tornquist" , "Trenque Lauquen" , "Tres Arroyos"
,"Tres Lomas", "Tres de Febrero" , "Vicente López" , "Villa Gesell" , "Villarino" , "Zárate"
)
# --- 4. AGREGAR CAMPO PARTIDO_ANSES
dptos_pba <- dptos_pba %>%
mutate(partidos_pba_anses = partidos_pba_anses )
# --- 5. OBTENER CABA SIN COMUNAS
caba_union <- dptos %>%
filter(grepl("^02", in1)) %>%
st_make_valid() %>%
summarise(geometry = st_union(geometry)) %>%
st_cast("MULTIPOLYGON") %>%
mutate(partido = "CABA",
partidos_pba_anses = "CABA")
# AGREGAR CABA A DF PBA
dptos_pba_caba <- bind_rows(dptos_pba, caba_union)
# --- 6. CARGAR DATOS DE COBERTURA
cobertura_pba_caba <- read_excel("mapa_cobertura_amba.xlsx")
# --- 7. UNIR GEODATA CON COBERTURA
data_mapa_pba_caba <- dptos_pba_caba %>%
left_join(cobertura_pba_caba, by = c("partidos_pba_anses" = "partidos_pba_anses"))
# --- 8. VECTOR PARA FILTRAR PARTIDOS DE INTERÉS   --> 40 PARTIDOS + CABA AMBA EXTENDIDO
partidos_amba_ext <- c(
"Almirante Brown", "Avellaneda", "Berazategui", "Berisso", "Brandsen",
"Campana", "Cañuelas", "Ensenada", "Escobar", "Esteban Echeverría",
"Exaltación de la Cruz", "Ezeiza", "Florencio Varela", "General Las Heras",
"General Rodríguez", "General San Martín", "Hurlingham", "Ituzaingó",
"José C. Paz", "La Matanza", "Lanús", "La Plata", "Lomas de Zamora",
"Luján", "Marcos Paz", "Malvinas Argentinas", "Moreno", "Merlo", "Morón",
"Pilar", "Presidente Perón", "Quilmes", "San Fernando", "San Isidro",
"San Miguel", "San Vicente", "Tigre", "Tres de Febrero", "Vicente López",
"Zárate", "CABA"
)
# ---9. ILTRAR PARTIDOS DE PBA QUE ESTÉN LISTADOS
data_mapa_amba <- data_mapa_pba_caba %>%
filter(partidos_pba_anses %in% partidos_amba_ext)
# --- 10. GRAFICAR MAPA DE PARTIDOS LISTADOS
mapa_amba_ext <- ggplot(data_mapa_amba) +
geom_sf(aes(fill = Cobertura), color = "white") +
scale_fill_gradient(
low = "#c6dbef",
high = "#08306b",
name = "% Cobertura"
) +
theme_minimal() +
labs(
title = "Cobertura por partido sobre total de menores",
subtitle= "40 partidos del AMBA + CABA",
caption = "Fuente: Elaboración propia en base a IGN, ANSES e INDEC"
) +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
mapa_amba_ext
mapa_amba_ext
library(plotly)
mapa_amba_ext <- ggplot(data_mapa_amba) +
geom_sf(
aes(
fill = Cobertura,
text = paste0(
"Partido: ", partidos_pba_anses, "<br>",
"Cobertura: ", round(Cobertura, 1), "%"
)
),
color = "white"
) +
scale_fill_gradient(
low = "#c6dbef",
high = "#08306b",
name = "% Cobertura"
) +
theme_minimal() +
labs(
title = "Cobertura por Partido - AMBA",
caption = "Fuente: IGN / Elaboración propia"
) +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
# convertir a interactivo
ggplotly(mapa_amba_ext, tooltip = "text")
## 1ro probar metodo wininet
install.packages("plotly",dependencies = TRUE, method="wininet")
library(plotly)
mapa_amba_ext <- ggplot(data_mapa_amba) +
geom_sf(
aes(
fill = Cobertura,
text = paste0(
"Partido: ", partidos_pba_anses, "<br>",
"Cobertura: ", round(Cobertura, 1), "%"
)
),
color = "white"
) +
scale_fill_gradient(
low = "#c6dbef",
high = "#08306b",
name = "% Cobertura"
) +
theme_minimal() +
labs(
title = "Cobertura por Partido - AMBA",
caption = "Fuente: IGN / Elaboración propia"
) +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
# convertir a interactivo
ggplotly(mapa_amba_ext, tooltip = "text")
library(plotly)
mapa_amba_ext_int <- ggplot(data_mapa_amba) +
geom_sf(
aes(
fill = Cobertura,
text = paste0(
"Partido: ", partidos_pba_anses, "<br>",
"Cobertura: ", round(Cobertura * 100, 1), "%"
)
),
color = "white"
) +
scale_fill_gradient(
low = "#c6dbef",
high = "#08306b",
name = "% Cobertura"
) +
theme_minimal() +
labs(
title = "Cobertura por partido sobre total de menores",
subtitle= "40 partidos del AMBA + CABA",
caption = "Fuente: Elaboración propia en base a IGN, ANSES e INDEC"
) +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
# convertir a interactivo
ggplotly(mapa_amba_ext_int, tooltip = "text")
knitr::opts_chunk$set(echo = TRUE)
### MAPA AMBA : 40 PARTIDOS + CABA
# --- 1. CARGAR SHAPEFILE IGN
dptos <- st_read("departamento/departamentoPolygon.shp")
# Carga de librerias
library(tidyverse)
library(readr)
library(stringr)
library(eph)
library(readxl)
library(writexl)
library(scales)
library(openxlsx)
library(ggplot2)
library(plotly)
library(patchwork)
library(kableExtra)
library(geodata)
library(sf)
# Configuración general: sin notación científica
options(scipen = 999)
# Funcion para formatear números
formato <- function(x){
format(x, digits = 2, big.mark = ".", decimal.mark = ",")
}
# Importar bases de datos, seleccionar variables de interés y crear variable " idhogar "
base_ind <- read.csv2("usu_individual_T424.txt") %>%
select(CODUSU, NRO_HOGAR, COMPONENTE, PONDERA, PONDIH,REGION, CH03, CH04, CH06,
ESTADO, EMPLEO, SECTOR, V5_01_M, ITF, IPCF, DECCFR, P_DECCF) %>%
mutate(idhogar = str_c(CODUSU, NRO_HOGAR))
base_hog <- read.csv2("usu_hogar_T424.txt") %>%
select(CODUSU, NRO_HOGAR, TRIMESTRE, REGION, PONDERA, PONDIH, V5_01, IX_TOT, ITF,
DECIFR, IPCF, DECCFR) %>%
mutate(idhogar = str_c(CODUSU, NRO_HOGAR))
### MAPA AMBA : 40 PARTIDOS + CABA
# --- 1. CARGAR SHAPEFILE IGN
dptos <- st_read("departamento/departamentoPolygon.shp")
# --- 2. FILTRAR PARTIDOS DE PBA
dptos_pba <- dptos %>%
filter(grepl("^06", in1)) %>%
mutate(partido = nam) %>%
arrange(partido)
# --- 3. PARTIDOS PBA NOMBRE ANSES     -> tuve que reordenar para pegarlo al df
partidos_pba_anses <-  c(
"25 de Mayo" , "9 de Julio" , "Adolfo Alsina" , "Adolfo Gonzales Chaves" , "Alberti" ,
"Almirante Brown" , "Arrecifes" , "Avellaneda" , "Ayacucho" , "Azul" , "Bahía Blanca" ,
"Balcarce" , "Baradero" , "Benito Juárez" , "Berazategui" , "Berisso" , "Bolívar" ,
"Bragado" , "Brandsen" , "Campana"  , "Capitán Sarmiento" , "Carlos Casares" ,
"Carlos Tejedor" , "Carmen de Areco" , "Castelli" , "Cañuelas",  "Chacabuco" , "Chascomús" , "Chivilcoy" ,
"Colón"  , "Coronel Dorrego" , "Coronel Pringles" ,  "Coronel Suárez" , "Coronel de Marina Leonardo Rosales",
"Daireaux" , "Dolores" , "Ensenada" , "Escobar" , "Esteban Echeverría" ,
"Exaltación de la Cruz" , "Ezeiza" , "Florencio Varela" , "Florentino Ameghino" ,
"General Alvarado" , "General Alvear" , "General Arenales" , "General Belgrano" ,
"General Guido" , "General Juan Madariaga" , "General La Madrid" , "General Las Heras"
, "General Lavalle" , "General Paz" , "General Pinto" , "General Pueyrredón" , "General Rodríguez"
, "General San Martín" , "General Viamonte" , "General Villegas" , "Guaminí" , "Hipólito Yrigoyen"
, "Hurlingham" , "Ituzaingó" , "José C. Paz" , "Junín" , "La Costa" , "La Matanza" , "La Plata" , "Lanús" ,
"Laprida" , "Las Flores" , "Leandro N. Alem" , "Lezama", "Lincoln" , "Lobería" , "Lobos" , "Lomas de Zamora" , "Luján"   # Tuve que agregar Lezama
, "Magdalena" , "Maipú" , "Malvinas Argentinas" , "Mar Chiquita" , "Marcos Paz" , "Mercedes" , "Merlo" , "Monte"
, "Monte Hermoso" , "Moreno" , "Morón" , "Navarro" , "Necochea" , "Olavarría" , "Patagones" , "Pehuajó" , "Pellegrini"
, "Pergamino" , "Pila" , "Pilar" , "Pinamar" , "Presidente Perón" , "Puán" , "Punta Indio" , "Quilmes" , "Ramallo" ,
"Rauch" , "Rivadavia" , "Rojas" , "Roque Pérez" , "Saavedra" , "Saladillo" , "Salliqueló" , "Salto" , "San Andrés de Giles" ,
"San Antonio de Areco" , "San Cayetano" , "San Fernando" , "San Isidro" , "San Miguel" , "San Nicolás" , "San Pedro" ,
"San Vicente" , "Suipacha" , "Tandil" , "Tapalqué" , "Tigre" , "Tordillo" , "Tornquist" , "Trenque Lauquen" , "Tres Arroyos"
,"Tres Lomas", "Tres de Febrero" , "Vicente López" , "Villa Gesell" , "Villarino" , "Zárate"
)
# --- 4. AGREGAR CAMPO PARTIDO_ANSES
dptos_pba <- dptos_pba %>%
mutate(partidos_pba_anses = partidos_pba_anses )
# --- 5. OBTENER CABA SIN COMUNAS
caba_union <- dptos %>%
filter(grepl("^02", in1)) %>%
st_make_valid() %>%
summarise(geometry = st_union(geometry)) %>%
st_cast("MULTIPOLYGON") %>%
mutate(partido = "CABA",
partidos_pba_anses = "CABA")
# AGREGAR CABA A DF PBA
dptos_pba_caba <- bind_rows(dptos_pba, caba_union)
# --- 6. CARGAR DATOS DE COBERTURA
cobertura_pba_caba <- read_excel("mapa_cobertura_amba.xlsx")  ### CHEQUEAR LA DATA
# --- 7. UNIR GEODATA CON COBERTURA
data_mapa_pba_caba <- dptos_pba_caba %>%
left_join(cobertura_pba_caba, by = c("partidos_pba_anses" = "partidos_pba_anses"))
# --- 8. VECTOR PARA FILTRAR PARTIDOS DE INTERÉS   --> 40 PARTIDOS + CABA AMBA EXTENDIDO
partidos_amba_ext <- c(
"Almirante Brown", "Avellaneda", "Berazategui", "Berisso", "Brandsen",
"Campana", "Cañuelas", "Ensenada", "Escobar", "Esteban Echeverría",
"Exaltación de la Cruz", "Ezeiza", "Florencio Varela", "General Las Heras",
"General Rodríguez", "General San Martín", "Hurlingham", "Ituzaingó",
"José C. Paz", "La Matanza", "Lanús", "La Plata", "Lomas de Zamora",
"Luján", "Marcos Paz", "Malvinas Argentinas", "Moreno", "Merlo", "Morón",
"Pilar", "Presidente Perón", "Quilmes", "San Fernando", "San Isidro",
"San Miguel", "San Vicente", "Tigre", "Tres de Febrero", "Vicente López",
"Zárate", "CABA"
)
# ---9. ILTRAR PARTIDOS DE PBA QUE ESTÉN LISTADOS
data_mapa_amba <- data_mapa_pba_caba %>%
filter(partidos_pba_anses %in% partidos_amba_ext)
# --- 10. GRAFICAR MAPA DE PARTIDOS LISTADOS
mapa_amba_ext <- ggplot(data_mapa_amba) +
geom_sf(aes(fill = Cobertura), color = "white") +
scale_fill_gradient(
low = "#c6dbef",
high = "#08306b",
name = "% Cobertura"
) +
theme_minimal() +
labs(
title = "Cobertura por partido sobre total de menores",
subtitle= "40 partidos del AMBA + CABA",
caption = "Fuente: Elaboración propia en base a IGN, ANSES e INDEC"
) +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
mapa_amba_ext
mapa_amba_ext
View(data_mapa_amba)
# ---9. FILTRAR PARTIDOS DE PBA QUE ESTÉN LISTADOS Y TRANSFORMAR EN %
data_mapa_amba <- data_mapa_pba_caba %>%
filter(partidos_pba_anses %in% partidos_amba_ext) %>%
mutate(Cobertura = Cobertura * 100)
# --- 10. GRAFICAR MAPA DE PARTIDOS LISTADOS
mapa_amba_ext <- ggplot(data_mapa_amba) +
geom_sf(aes(fill = Cobertura), color = "white") +
scale_fill_gradient(
low = "#c6dbef",
high = "#08306b",
name = "% Cobertura"
) +
theme_minimal() +
labs(
title = "Cobertura por partido sobre total de menores",
subtitle= "40 partidos del AMBA + CABA",
caption = "Fuente: Elaboración propia en base a IGN, ANSES e INDEC"
) +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
mapa_amba_ext
mapa_amba_ext_int <- ggplot(data_mapa_amba) +
geom_sf(
aes(
fill = Cobertura,
text = paste0(
"Partido: ", partidos_pba_anses, "<br>",
"Cobertura: ", round(Cobertura, 1), "%"
)
),
color = "white"
) +
scale_fill_gradient(
low = "#c6dbef",
high = "#08306b",
name = "% Cobertura"
) +
theme_minimal() +
labs(
title = "Cobertura por partido sobre total de menores",
subtitle= "40 partidos del AMBA + CABA",
caption = "Fuente: Elaboración propia en base a IGN, ANSES e INDEC"
) +
theme(
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()
)
# convertir a interactivo
ggplotly(mapa_amba_ext_int, tooltip = "text")
